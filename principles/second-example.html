<!DOCTYPE html>
<html lang="en">

  <head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-111495058-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-111495058-1');
</script>

    <!-- Title -->
    <title>FDB Research</title>

    <!-- Required Meta Tags Always Come First -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="keywords" content="Factorised,Factorized,Factorised Databases,Factorized Databases,join,query,FDB,FDBResearch,Databases,CS,Compression,Worst-case optimal,Oxford,University of Oxford,Computer Science">
    <meta name="description" content="We investigate foundational and systems aspects of scalable data management at the confluence of compression, distribution, and approximation for mixed query and machine learning workloads on relational data.">

    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
    <link rel="manifest" href="../manifest.json">
    <link rel="mask-icon" href="../safari-pinned-tab.svg" color="#4270a9">
    <meta name="theme-color" content="#ffffff">

    <!-- <base href="../"> -->
    <!-- Google Fonts -->
    <!-- <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans%3A400%2C300%2C500%2C600%2C700%7CPlayfair+Display%7CRoboto%7CRaleway%7CSpectral%7CRubik"> -->
    <!-- CSS Global Compulsory -->
    <link rel="stylesheet" href="../assets/vendor/bootstrap/bootstrap.min.css">
    <!-- CSS Global Icons -->
    <link rel="stylesheet" href="../assets/vendor/icon-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="../assets/vendor/icon-line/css/simple-line-icons.css">
    <link rel="stylesheet" href="../assets/vendor/icon-etlinefont/style.css">
    <link rel="stylesheet" href="../assets/vendor/icon-line-pro/style.css">
    <link rel="stylesheet" href="../assets/vendor/icon-hs/style.css">
    <link rel="stylesheet" href="../assets/vendor/cubeportfolio-full/cubeportfolio/css/cubeportfolio.min.css">
    <link rel="stylesheet" href="../assets/vendor/animate.css">
    <link rel="stylesheet" href="../assets/vendor/hs-megamenu/src/hs.megamenu.css">
    <link rel="stylesheet" href="../assets/vendor/hamburgers/hamburgers.min.css">

    <link rel="stylesheet" href="../assets/vendor/slick-carousel/slick/slick.css">

    <!-- CSS Unify -->
    <link rel="stylesheet" href="../assets/css/unify-core.css">
    <link rel="stylesheet" href="../assets/css/unify-components.css">
    <link rel="stylesheet" href="../assets/css/unify-globals.css">

    <!-- CSS Customization -->
    <link rel="stylesheet" href="../assets/css/custom.css">
    
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML"></script>
  </head>

  <body>
    <main>


    <!-- Header -->
    <header id="js-header" class="u-header u-header--static u-shadow-v19">
      <div class="u-header__section u-header__section--light g-bg-white g-transition-0_3 g-py-10">
        <nav class="js-mega-menu navbar navbar-expand-lg">
          <div class="container">
            <!-- Responsive Toggle Button -->
            <button class="navbar-toggler navbar-toggler-right btn g-line-height-1 g-brd-none g-pa-0 g-pos-abs g-top-3 g-right-0" type="button"
              aria-label="Toggle navigation" aria-expanded="false" aria-controls="navBar" data-toggle="collapse" data-target="#navBar">
              <span class="hamburger hamburger--slider">
                <span class="hamburger-box">
                  <span class="hamburger-inner"></span>
                </span>
              </span>
            </button>
            <!-- End Responsive Toggle Button -->

            <!-- Logo -->
            <a href="index.html" class="navbar-brand">
              <img height="40px" src="../assets/img/logo/logo-fdb.png" alt="Image Description">
            </a>
            <!-- End Logo -->

            <!-- Navigation -->
            <div class="collapse navbar-collapse align-items-center flex-sm-row g-pt-10 g-pt-5--lg g-mr-40--lg" id="navBar">

              <ul class="navbar-nav text-uppercase g-pos-rel g-font-weight-600 ml-auto">
                <!-- Home -->
                <li class="nav-item  g-mx-10--lg g-mx-15--xl">
                  <a href="../index.html" class="nav-link g-py-7 g-px-0">Home</a>
                </li>
                <!-- End Home -->
                <!-- Projects -->
                <li class="nav-item hs-has-sub-menu  g-mx-10--lg g-mx-15--xl" data-animation-in="fadeIn" data-animation-out="fadeOut">
                    <a id="nav-link--features" class="nav-link g-py-7 g-px-0" href="#" aria-haspopup="true" aria-expanded="false" aria-controls="nav-submenu--features">News</a>
  
                    <ul class="hs-sub-menu list-unstyled u-shadow-v11 g-brd-top g-brd-primary g-brd-top-2 g-min-width-220 g-mt-21 g-mt-11--lg--scrolling"
                      id="nav-submenu--features" aria-labelledby="nav-link--features">
                      <li class="dropdown-item ">
                        <a class="nav-link" href="../visitors.html">
                          Visitors</a>
                      </li>
                      <li class="dropdown-item ">
                        <a class="nav-link" href="../events.html">
                          Events</a>
                      </li>
                      <li class="dropdown-item ">
                        <a class="nav-link" href="../awards.html">Student Awards</a>
                      </li>
                    </ul>
                  </li>
                  <!-- End Projects -->
                <li class="nav-item  g-mx-10--lg g-mx-15--xl">
                  <a href="../people.html" class="nav-link g-py-7 g-px-0">People</a>
                </li>

                <!-- Projects -->
                <li class="nav-item hs-has-sub-menu  g-mx-10--lg g-mx-15--xl" data-animation-in="fadeIn" data-animation-out="fadeOut">
                  <a id="nav-link--features" class="nav-link g-py-7 g-px-0" href="#" aria-haspopup="true" aria-expanded="false" aria-controls="nav-submenu--features">Projects</a>

                  <ul class="hs-sub-menu list-unstyled u-shadow-v11 g-brd-top g-brd-primary g-brd-top-2 g-min-width-220 g-mt-21 g-mt-11--lg--scrolling"
                    id="nav-submenu--features" aria-labelledby="nav-link--features">
                    <li class="dropdown-item ">
                      <a class="nav-link" href="../principles.html">
                        Principles of Factorised Databases</a>
                    </li>
                    <li class="dropdown-item ">
                      <a class="nav-link" href="../analytics.html">In-Database Analytics</a>
                    </li>
                    <li class="dropdown-item ">
                      <a class="nav-link" href="../ivm.html">Incremental Maintenance for Analytics</a>
                    </li>
                  </ul>
                </li>
                <!-- End Projects -->

                <li class="nav-item  g-mx-10--lg g-mx-15--xl">
                  <a href="../publications.html" class="nav-link g-py-7 g-px-0">Publications</a>
                </li>
                <li class="nav-item  g-mx-10--lg g-mx-15--xl">
                  <a href="../talks.html" class="nav-link g-py-7 g-px-0">Talks</a>
                </li>




                <li class="nav-item  g-mx-10--lg g-mx-15--xl">
                  <a href="../acknowledgements.html" class="nav-link g-py-7 g-px-0">Acknowledgements</a>
                </li>

                <li class="nav-item  g-mx-10--lg g-mx-15--xl">
                  <a href="../contacts.html" class="nav-link g-py-7 g-px-0">Contact</a>
                </li>

              </ul>
            </div>
            <!-- End Navigation -->

          </div>
        </nav>
      </div>
    </header>
    <!-- End Header -->


      <!-- Breadcrumbs -->
      <section class="g-bg-gray-light-v5 g-py-50">
        <div class="container">
          <div class="d-sm-flex text-center">
            <div class="align-self-center">
              <h2 class="h2 g-font-weight-300 w-100 g-mb-10 g-mb-0--md">Example: Aggregates over Factorised Joins</h2>
            </div>

          </div>
        </div>
      </section>
      <!-- End Breadcrumbs -->

      <div class="g-pt-50"></div>


      <!-- Blog Minimal Blocks -->

      <div class="container g-pb-20">
        <div class="row justify-content-between">
          <!-- left panel -->
          <div class="col-lg-1 g-mb-80"></div>
          <!-- end left panel -->
          <!-- Articles Content -->
          <div class="col-lg-10 g-mb-50 g-mb-0--lg">
            <article class="g-mb-60">
              
              <div class="g-font-size-18 g-color-black-opacity-1_0 g-line-height-1_6 g-mb-30">
              
              <h3 class="h3 g-color-gray-dark-v1 g-font-weight-600 g-mb-10">Redundancy in Join Results</h3>

                <p class="example g-color-black-opacity-0_8">
                Consider the following database with three relations <tt>Orders</tt> (O), <tt>Dish</tt> (D), and <tt>Items</tt> (I).
                </p>

                <figure class="u-shadow-v25 g-mb-30">
                  <img class="img-fluid w-100" src="orders-dish-items-db.png" alt="Example Database">
                </figure>

                <p class="example g-color-black-opacity-0_8">    
                The natural join of the three relations entails loads of redundancy, as shown below for a fragment of it. For instance, the values <tt>Elise</tt> and <tt>burger</tt> appear in all tuples in this fragment.
                </p>
                            
                <figure class="u-shadow-v25 g-mb-30">
                  <img class="img-fluid w-100" src="orders-dish-items-join.png" alt="Fragment of the Natural Join of Database Relations">
                </figure>
                
                <h3 class="h3 g-color-gray-dark-v1 g-font-weight-600 g-mb-10">Getting Rid of Redundancy using Factorisation</h3>

                
                <p class="example g-color-black-opacity-0_8">    
                How can we get rid of this redundancy? Let us have a closer look at this result fragment through relational algebra glasses. This relation can be expressed in relational algebra using the operators union and Cartesian product over singleton relations (relations with one column and one row).
                </p>
                            
                <figure class="u-shadow-v25 g-mb-30">
                  <img class="img-fluid w-100" src="orders-dish-items-algebra.png" alt="Fragment of the Natural Join of Database Relations">
                </figure>
                         
                <p class="example g-color-black-opacity-0_8">    
                We can simplify this algebraic expression by using the distributivity of the product over union to <em>factor out</em> common subexpressions. One possible factorisation is given below (right). Its structure (left) is given by a partial order on the query variables, or <em>variable order</em> for short, which is sometimes called <em>f-tree</em> for factorisation tree; a more refined version is called <em>d-tree</em>.<br/> 
                The f-tree below means the following: We first enumerate the possible <tt>dishes</tt>. For each <tt>dish</tt>, we consider independently the list of <tt>days</tt> when the dish is ordered from the list of component <tt>items</tt> of the <tt>dish</tt>. Under each <tt>day</tt>, we enumerate the <tt>customers</tt> who ordered on that <tt>day</tt> the <tt>dish</tt>. Also, under each <tt>item</tt>, we have its <tt>price</tt>.
                </p>                         
                                                
                <figure class="u-shadow-v25 g-mb-30">
                  <img class="img-fluid w-100" src="orders-dish-items-factorisation1.png" alt="Factorised Join over F-tree">
                </figure>
                
                <p class="example g-color-black-opacity-0_8">    
                The above factorisation exploits some of the <em>join dependencies</em>, or equivalently the conditional independence, present in the join result: Given the <tt>dish</tt> variable, the variables <tt>day</tt> and <tt>customer</tt> on one hand and the variables <tt>item</tt> and <tt>price</tt> on the other hand are independent in the sense that values for the latter do not restrict the possible values for the former.<br/>
                 In f-trees, a variable is assumed to depend on all its ancestor variables. This simplification leads to factorisations that are trees: For each tuple of values of the ancestor variables, we list the possible valid values of the current variable. This assumption is not necessarily justified. For instance, <tt>price</tt> does not depend on <tt>dish</tt> given <tt>item</tt>. In general, a variable may only depend on a subset of its ancestors.<br/> The d-trees, which are variable orders that refine f-trees, explicitly associate with each variable its dependency set that consists of those ancestor variables on which it depends or its descendants depend. The d-trees may lead to more compact factorisations, as depicted next.
                </p>                         
                                                
                <figure class="u-shadow-v25 g-mb-30">
                  <img class="img-fluid w-100" src="orders-dish-items-factorisation2.png" alt="Factorised Join over D-tree">
                </figure>
                
                <p class="example g-color-black-opacity-0_8">    
                The above factorisations are not the only one possible for our join result. Indeed, different variable orders lead to different factorisations. The factorisation below is over an f-tree that is a path; in this case, the factorisation becomes a trie and does not exploit the join dependencies.
                </p>                   
                
                <figure class="u-shadow-v25 g-mb-30">
                  <img class="img-fluid w-100" src="orders-dish-items-factorisation3.png" alt="Factorised Join over a Path F-tree">
                </figure>
                
                <p class="example g-color-black-opacity-0_8">    
                We can turn the previous path f-tree into a d-tree by noting the conditional independence between the query variables. The factorisation over this d-tree now becomes much more compact.
                </p>                   
                
                <figure class="u-shadow-v25 g-mb-30">
                  <img class="img-fluid w-100" src="orders-dish-items-factorisation4.png" alt="Factorised Join over a D-tree">
                </figure>
                 
                <p class="example g-color-black-opacity-0_8">    
                An important question is which d-trees lead to asymptotically smallest factorisations and hence of worst-case optimal size within the class of factorisations whose structure is given by f-trees and respectively d-trees. This question is answered in the <a href="../principles.html#oz-icdt12">ICDT'12 paper</a> for f-trees and in the <a href="../principles.html#oz-tods15">TODS'15 article</a> for d-trees.
                </p>
                
                
                <h3 class="h3 g-color-gray-dark-v1 g-font-weight-600 g-mb-10">How To Compute Factorised Joins?</h3>                
                
                <p class="example g-color-black-opacity-0_8">
                Given a variable order, we can compute the factorisation in worst-case optimal time. At each variable in the order, we compute the join of all relations on that variable: At <tt>dish</tt>, we intersect the relations Orders (O) and Dish (D) on <tt>dish</tt>;  at <tt>day</tt>, we look up into Orders the days for a given <tt>dish</tt> and then at <tt>customer</tt> we look up into Orders the customers for the given day and dish. We proceed similarly on the right branch. These lookups and intersections can be done efficiently if the relations are sorted following a topological order of the variable order. To guarantee optimality, the intersection of several lists needs to take time linear in the size of the smallest list (modulo a log factor).                
                </p>                   
 
                 <figure class="u-shadow-v25 g-mb-30">
                  <img class="img-fluid w-100" src="orders-dish-items-evaluation.png" alt="Factorised Join over a D-tree">
                </figure>

                <h3 class="h3 g-color-gray-dark-v1 g-font-weight-600 g-mb-10">How To Compute Aggregates over Factorised Joins?</h3>                
 
                <p class="example g-color-black-opacity-0_8">    
                We now turn to a different question: How to evaluate aggregates over the previous factorised join? It turns out that common SQL aggregates, such as <tt>SUM</tt>, <tt>MIN</tt>, and <tt>MAX</tt> can be evaluated in one pass over factorisations.<br/>
                Consider the computation of the count aggregate <tt>COUNT(*)</tt> over our above factorisation whose structure is given by the d-tree with two branches. This aggregate computes the number of tuples in the join result. We do this in one bottom-up pass over the factorisation, where we interpret each singleton relation as  value 1 and map each union and Cartesian product operator to arithmetic addition and respectively multiplication. As shown below, the factorisation saves computation time by avoiding counting the tuples and instead replacing a summation of the same number by multiplication.
                </p>     
                
                <figure class="u-shadow-v25 g-mb-30">
                  <img class="img-fluid w-100" src="orders-dish-items-agg1.png" alt="COUNT Aggregate over Factorised Join">
                </figure>
 
                 <p class="example g-color-black-opacity-0_8">    
                More complex aggregates are also possible. Below is the case of the aggregate <tt>SUM(dish * price)</tt>: We map all values except for <tt>dish</tt> and <tt>price</tt> to 1, union and product to arithmetic addition and respectively multiplication. Since <tt>dish</tt> is not a numerical variable, we assume here there is a function $f$ that turns <tt>dish</tt> into reals.  
                </p>     
                
                <figure class="u-shadow-v25 g-mb-30">
                  <img class="img-fluid w-100" src="orders-dish-items-agg2.png" alt="SUM Aggregate over Factorised Join">
                </figure>
 
                 <p class="example g-color-black-opacity-0_8">    
                The above aggregates have no GROUP-BY clauses (or free variables). We can compute them as exemplified above in one pass over factorisations with any structure. This is not the case however for aggregate with GROUP-BY clauses, whose computation is sensitive to the structure of the factorisation: In particular, as long as the GROUP-BY variables lie above the other variables in the variable order, the aggregates can be computed in one pass over the factorisation. Furthermore, the computation of ORDER-BY clauses is also sensitive to the structure of the factorisation: Like for GROUP-BY, the ORDER-BY variables need to lie above the other variables in the variable order. Moreover, the order of the ORDER-BY variables must match a topological order of the variable order.<br/>
                More on this topic is available in the <a href="../principles.html#bkoz-pvldb13">PVLDB'13</a> and the more recent <a href="../principles.html#os-sigrec16">SIGMOD Record'16</a> articles. 
                
                </p>    
                
          </div>

            </article>


            <div id="stickyblock-end"></div>
          </div>
          <!-- End Articles Content -->

          <!-- right panel -->
          <div class="col-lg-1 g-mb-80"></div>
          <!-- end right panel -->


        </div>




      </div>
      <!-- End Blog Minimal Blocks -->


    <!-- Footer -->
    <div class="g-pt-50">
        <footer class="g-bg-secondary">
          <div class="g-brd-bottom g-brd-secondary-light-v2 g-py-20 "></div>
  
          <div class="container">
            <!-- Footer - Bottom Section -->
            <div class="row align-items-center">
              <div class="col-md-2 g-brd-right--md g-brd-secondary-light-v2 g-mb-30">
                <!-- Copyright -->
                <p class="g-color-secondary-light-v1 g-font-size-12 mb-0">&copy; 2017 All Rights Reserved.</p>
                <!-- End Copyright -->
              </div>
  
              <div class="col-md-8 g-brd-right--md g-brd-secondary-light-v2 g-mb-30">
                <!-- Links -->
                <ul class="list-inline mb-0">
                  <li class="list-inline-item g-pl-0 g-pr-10">
                    <a class="u-link-v5 g-color-black-opacity-0_5 g-font-size-12" href="contacts.html">Contact Us</a>
                  </li>
                  <li class="list-inline-item g-px-10">
                      <a class="u-link-v5 g-color-black-opacity-0_5 g-font-size-12" >Last modified: 14 October 2019</a>
                  </li>
                </ul>
                <!-- End Links -->
              </div>
  
  
            </div>
            <!-- End Footer - Bottom Section -->
          </div>
        </footer>
      </div>
      <!-- End Footer -->
  




    </main>

    <!-- JS Global Compulsory -->
    <script src="../assets/vendor/jquery/jquery.min.js"></script>
    <script src="../assets/vendor/jquery-migrate/jquery-migrate.min.js"></script>
    <script src="../assets/vendor/jquery.easing/js/jquery.easing.js"></script>
    <script src="../assets/vendor/popper.min.js"></script>
    <script src="../assets/vendor/bootstrap/bootstrap.min.js"></script>

    <!-- JS Implementing Plugins -->
    <script src="../assets/vendor/appear.js"></script>
    <script src="../assets/vendor/hs-megamenu/src/hs.megamenu.js"></script>
    <script src="../assets/vendor/masonry/dist/masonry.pkgd.min.js"></script>
    <script src="../assets/vendor/imagesloaded/imagesloaded.pkgd.min.js"></script>
    <script src="../assets/vendor/cubeportfolio-full/cubeportfolio/js/jquery.cubeportfolio.min.js"></script>

    <script src="../assets/vendor/slick-carousel/slick/slick.js"></script>

    <!-- JS Unify -->
    <script src="../assets/js/hs.core.js"></script>
    <script src="../assets/js/components/hs.header.js"></script>
    <script src="../assets/js/helpers/hs.hamburgers.js"></script>
    <script src="../assets/js/components/hs.dropdown.js"></script>
    <script src="../assets/js/components/hs.tabs.js"></script>
    <script src="../assets/js/components/hs.cubeportfolio.js"></script>
    <script src="../assets/js/components/hs.onscroll-animation.js"></script>
    <script src="../assets/js/components/hs.go-to.js"></script>
    <script src="../assets/js/components/hs.carousel.js"></script>

    <!-- JS Customization -->
    <script src="../assets/js/custom.js"></script>

    <!-- JS Plugins Init. -->
    <script>
      $(document).on('ready', function () {
      // initialization of tabs
      $.HSCore.components.HSTabs.init('[role="tablist"]');

      // initialization of scroll animation
      $.HSCore.components.HSOnScrollAnimation.init('[data-animation]');

      // initialization of go to
      $.HSCore.components.HSGoTo.init('.js-go-to');

      // initialization of HSDropdown component
      $.HSCore.components.HSDropdown.init($('[data-dropdown-target]'), {
      afterOpen: function () {
      $(this).find('input[type="search"]').focus();
      }
      });

      });



      $(window).on('load', function () {
      // initialization of header
      $.HSCore.components.HSHeader.init($('#js-header'));
      $.HSCore.helpers.HSHamburgers.init('.hamburger');

      // initialization of HSMegaMenu component
      $('.js-mega-menu').HSMegaMenu({
      event: 'hover',
      pageContainer: $('.container'),
      breakpoint: 991
      });

      // initialization of masonry
      $('.masonry-grid').imagesLoaded().then(function () {
      $('.masonry-grid').masonry({
      columnWidth: '.masonry-grid-sizer',
      itemSelector: '.masonry-grid-item',
      percentPosition: true
      });
      });

      // initialization of cubeportfolio
      $.HSCore.components.HSCubeportfolio.init('.cbp');
      });

      $(window).on('resize', function () {
      setTimeout(function () {
      $.HSCore.components.HSTabs.init('[role="tablist"]');
      }, 200);
      });
    </script>

  </body>

</html>
